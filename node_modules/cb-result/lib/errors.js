/**
 * Created by Ralph Varjabedian on 1/14/14.
 * require-hook is licensed under the [MIT]
 * do not remove this notice.
 */
'use strict';

var assert = require("assert");
var errors = [];

//code, enum, desc, regex?
errors.push({code: -2, enum: "multiple", desc: "multiple error(s)"});
errors.push({code: -1, enum: "generic", desc: "generic error"});

var errorStore = {};
errorStore.defaultErrorCode = -1;
errorStore.get = function(errorCode) {
  if(errorCode && errorCode.IsErrorCode) {
    return errorCode;
  }
  return this[errorCode] ? this[errorCode] : this.get(this.defaultErrorCode);
};
errorStore.find = function(errorText) {
  for(var i = 0; i < errors.length; i++) {
    if(errors[i].regex && errors[i].regex.test(errorText)) {
      return errors[i];
    }
  }
  return null;
};

errorStore.add = function(code, enm, desc, regex) {
  if(arguments.length === 1) {
    assert(code.code);
    assert(code.enum);
    assert(code.desc);
    code.IsErrorCode = true;
    errorStore["" + code.code] = code;
    errorStore[code.code] = code;
    errorStore[code.enum] = code;
    errors.push(code);
  } else {
    errorStore.add({code: code, enum: enm, desc: desc, regex: regex});
  }
};

(function() {
  for(var i = 0; i < errors.length; i++) {
    var e = errors[i];
    e.IsErrorCode = true;
    errorStore["" + e.code] = e;
    errorStore[e.code] = e;
    errorStore[e.enum] = e;
  }
})();

module.exports = errorStore;
